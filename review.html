<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Osano Implementation Review</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Jost:wght@400;700&family=Lato:wght@400;700&display=swap');

    body {
      font-family: 'Lato', sans-serif;
      max-width: 1000px;
      margin: auto;
      padding: 30px;
      background: linear-gradient(to bottom right, #F0E7FA, #ffffff);
      color: #0E0416;
    }

    h1, h2, h3 {
      font-family: 'Jost', sans-serif;
      color: #7A3FF1;
    }

    .question {
      margin: 20px 0;
      padding: 15px;
      border-left: 6px solid #ccc;
      border-radius: 6px;
      background: #ffffff;
      box-shadow: 0 1px 5px rgba(0,0,0,0.05);
    }

    .high-risk { border-color: #F04438; background: #FFE5E5; }
    .medium-risk { border-color: #F79009; background: #FFF5E5; }
    .low-risk { border-color: #12B76A; background: #E5FFE5; }

    label { display: block; margin: 5px 0; }
    textarea {
      width: 100%;
      padding: 8px;
      margin-top: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: 'Lato', sans-serif;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      background: linear-gradient(90deg, #7A3FF1, #C57EC4);
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 4px 12px rgba(122, 63, 241, 0.3);
    }

    .report {
      background: #ffffff;
      border-left: 6px solid #7A3FF1;
      padding: 25px;
      margin-top: 40px;
      border-radius: 10px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }

    .report ul { padding-left: 20px; }
    .risk-high { color: #F04438; font-weight: bold; }
    .risk-medium { color: #F79009; font-weight: bold; }
    .risk-low { color: #12B76A; font-weight: bold; }

    .qa-summary {
      margin-top: 30px;
      padding: 20px;
      border-radius: 6px;
      background: #F8F8FA;
      border-left: 4px solid #7A3FF1;
    }

    .qa-summary h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>
  <h1>Osano Implementation Self-Review</h1>
  <p>Select answers for each implementation best practice question below. Add notes where relevant. At the end, you'll receive a customized report with prioritized recommendations you can export to PDF.</p>

  <form id="reviewForm">
    <!-- Form dynamically inserted elsewhere -->
  </form>

  <div id="report" class="report" style="display:none;"></div>
  <button id="downloadBtn" style="display:none; margin-top:10px;">Download as PDF</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const checks = [
      {name: 'classified', label: 'Are all scripts and cookies properly classified?', text: 'Ensure every script is placed in the correct category (Essential, Marketing, etc.) to enforce meaningful consent.', risk: 'high'},
      // ... other questions follow this same structure ...
    ];

    const form = document.getElementById('reviewForm');
    checks.forEach(({name, label, risk}) => {
      const riskClass = risk === 'high' ? 'high-risk' : risk === 'medium' ? 'medium-risk' : 'low-risk';
      const div = document.createElement('div');
      div.className = `question ${riskClass}`;
      div.innerHTML = `
        <strong>${label}</strong>
        <label><input type="radio" name="${name}" value="yes"> Yes</label>
        <label><input type="radio" name="${name}" value="no"> No</label>
        <label for="note-${name}"><em>Optional Notes:</em></label>
        <textarea name="note-${name}" rows="2" placeholder="Add specific details like '_ga is classified as essential, should be analytics'."></textarea>
      `;
      form.appendChild(div);
    });

    const button = document.createElement('button');
    button.type = 'button';
    button.textContent = 'Generate Report';
    button.onclick = generateReport;
    form.appendChild(button);

    function generateReport() {
      const report = document.getElementById('report');
      const downloadBtn = document.getElementById('downloadBtn');
      let html = '<h2>Implementation Review Report</h2>';
      html += '<p>Below is a summary of identified issues along with risk levels and tailored recommendations for remediation.</p><ul>';
      let qa = '<div class="qa-summary"><h3>Full Question & Answer Summary</h3><ul>';

      checks.forEach(({name, label, text, risk}) => {
        const value = form[name]?.value;
        const notes = form[`note-${name}`]?.value.trim();
        const answer = value === 'yes' ? '✅ Yes' : value === 'no' ? '❌ No' : '—';
        qa += `<li><strong>${label}</strong><br/>Answer: <em>${answer}</em>${notes ? `<br/><strong>Notes:</strong> ${notes}` : ''}</li>`;

        if (value === 'no') {
          const riskLabel = risk === 'high' ? 'risk-high' : risk === 'medium' ? 'risk-medium' : 'risk-low';
          html += `<li><span class="${riskLabel}">${risk.toUpperCase()}:</span> <strong>${label}</strong><br/>${text}${notes ? `<br/><em>Additional Notes:</em> ${notes}` : ''}</li>`;
        }
      });

      qa += '</ul></div>';
      html += '</ul>' + qa;

      report.innerHTML = html;
      report.style.display = 'block';
      downloadBtn.style.display = 'inline-block';
    }

    document.getElementById('downloadBtn').addEventListener('click', () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'pt', format: 'a4' });
      doc.html(document.getElementById('report'), {
        callback: function (pdf) {
          pdf.save('osano-review-report.pdf');
        },
        x: 20,
        y: 20
      });
    });
  </script>
</body>
</html>
