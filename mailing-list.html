<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sign up for our mailing list to stay informed on the magical privacy debate.">
    <title>Join Our Mailing List!</title>
    <script>
        window.dataLayer = window.dataLayer ||[];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent','default',{
            'ad_storage':'denied',
            'analytics_storage':'denied',
            'ad_user_data':'denied',
            'ad_personalization':'denied',
            'personalization_storage':'denied',
            'functionality_storage':'granted',
            'security_storage':'granted',
            'wait_for_update': 500
        });
        gtag("set", "ads_data_redaction", true);
    </script>
    
    <script src="https://cmp.osano.com/AzZcpvRm9bbsqngN/627e5e74-8a01-47df-8d04-116e0ef84981/osano.js"></script> 

<script
 data-config-id="411811b1-f74e-4983-8338-f49aa02cc0b8"
 data-customer-id="AzZcmYSAwgobK6dI"
 src="https://clientapps.osano.com/uc-opt/index.js"
></script>
    
    <style>
        /* Set up Flexbox layout for the whole page */
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            color: #333;
            background-color: #f9f9f9;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Flex container for content */
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        /* Header styles */
        header {
            background-color: #4b0082;
            color: #fff;
            padding: 1em;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin: 0;
        }

        /* Container for the form */
        .container {
            max-width: 500px;
            padding: 2em;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        h2 {
            color: #4b0082;
        }

        /* Form styles */
        form {
            display: flex;
            flex-direction: column;
            gap: 1em;
            margin-top: 1em;
        }
        
        label {
            text-align: left;
            font-weight: bold;
        }

        input[type="text"],
        input[type="email"] {
            padding: 0.8em;
            font-size: 1em;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        input[type="submit"] {
            padding: 1em;
            font-size: 1em;
            color: #fff;
            background-color: #4b0082;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type="submit"]:hover {
            background-color: #3a0069;
        }

        /* Footer styles */
        footer {
            background-color: #4b0082;
            color: #fff;
            padding: 1em;
            text-align: center;
        }

        footer a {
            color: #ffd700;
            text-decoration: none;
            margin: 0 10px;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Link styling */
        a {
            color: #4b0082;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
               .osano-cm-widget {
            display: none;
        }
    </style>
</head>
<body>

    <main>
        <div class="container">
            <h2>Join Our Mailing List!</h2>
            <p>Stay up to date on all the latest developments in the magical privacy debate.</p>

            <!-- Mailing List Form -->
            <form action="your-backend-url-here" method="post">
                <label for="first-name">First Name:</label>
                <input type="text" id="first-name" name="first_name" required>

                <label for="last-name">Last Name:</label>
                <input type="text" id="last-name" name="last_name" required>

                <label for="email">Email Address:</label>
                <input type="email" id="email" name="email" required>

                <input type="submit" value="Subscribe">
            </form>
        </div>
        
        <!-- Go Home Link -->
        <a href="https://skyeerin.github.io/could-i-be-anymore-compliant/" class="go-home">Go Home</a>
    </main>
   
    <footer>
        <p>&copy; 2024 Privacy in Fiction. All rights reserved.</p>
        <p>
            <a href="privacy-policy.html">Privacy Policy</a> |
            <a href="subject-rights-request.html">Subject Rights Request</a> |
            <a href="privacy-center.html">Privacy Center</a> |
            <a href="#" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Manage Cookie Preferences</a>
        </p>
    </footer>

    
    <script>
        // Initialize global variable to store user consent identifier
        let userConsentId = null;

        console.log("Initializing Osano Unified Consent SDK...");

        // 1. Initialize Osano's Unified Consent SDK
        window.unifiedConsentJsSdkUnifiedConsentByOsanoSDK.init({
            onConsentUpdated: (consentData) => {
                console.log("Consent data received:", consentData);

                // 2. Check if user has provided consent
                if (consentData && consentData.consentId) {
                    // Save the consent ID for later use
                    userConsentId = consentData.consentId;
                    console.log('Consent recorded with ID:', userConsentId);
                } else {
                    console.warn('No consent ID found in consentData:', consentData);
                }
            }
        });

        // 3. Form submission handler to associate email with consent record
        document.getElementById('mailing-list-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the default form submission

            const email = document.getElementById('email').value;
            console.log("Form submitted with email:", email);

            if (userConsentId) {
                console.log("User consent ID available:", userConsentId);
                
                // Prepare form data for submission
                const formData = new FormData(this);
                formData.append('consent_id', userConsentId);

                console.log("Form data prepared for submission:", Array.from(formData.entries()));

                // Send form data to the backend
                fetch(this.action, {
                    method: 'POST',
                    body: formData
                }).then(response => {
                    if (response.ok) {
                        console.log('Form submitted successfully with consent ID:', userConsentId);
                        alert('Subscription successful! Your consent has been recorded.');
                    } else {
                        console.error('Error submitting form. Response status:', response.status);
                        alert('There was an error. Please try again.');
                    }
                }).catch(error => {
                    console.error('Submission error:', error);
                    alert('There was an error submitting the form. Please try again.');
                });
            } else {
                console.warn("No consent ID found. User needs to provide consent first.");
                alert('Please provide consent first.');
            }
        });
    </script>

</body>
</html>

